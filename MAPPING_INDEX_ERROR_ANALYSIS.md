# æ˜ å°„æ¨¡æ¿ç´¢å¼•é”™è¯¯åˆ†ææŠ¥å‘Š

## ğŸ¯ é—®é¢˜ï¼šå¹´é¾„åˆ†å¸ƒå›¾æ— æ³•ä¸Šä¼ 

é€šè¿‡äº‘å‡½æ•°æ—¥å¿—å’Œæ•°æ®åº“é…ç½®å¯¹æ¯”ï¼Œå‘ç°**å¤šä¸ªå›¾ç‰‡å­—æ®µçš„ç´¢å¼•æ˜ å°„éƒ½æ˜¯é”™è¯¯çš„**ï¼

---

## ğŸ“Š å¯¹æ¯”åˆ†æ

### å®é™…çš„ screenshots æ•°ç»„é¡ºåº

æ ¹æ®å‰ç«¯æˆªå›¾å’Œäº‘å‡½æ•°ä¸Šä¼ æ—¥å¿—ç¡®è®¤ï¼š

| ç´¢å¼• | å›¾ç‰‡åç§° | è¯´æ˜ |
|------|---------|------|
| [0] | è¾¾äººä»·æ ¼.png | æ˜Ÿå›¾ä»·æ ¼æˆªå›¾ |
| [1] | æ˜Ÿå›¾è§†é¢‘.png | è¿‘ä¸‰åå¤©è¾¾äººå•†å•vvä¸­ä½æ•° |
| [2] | ç”·å¥³æ¯”ä¾‹.png | è§‚ä¼—ç”»åƒ-æ€§åˆ« |
| **[3]** | **å¹´é¾„åˆ†å¸ƒ.png** | **è§‚ä¼—ç”»åƒ-å¹´é¾„** â† å½“å‰ç¼ºå¤± |
| [4] | åŸå¸‚ç­‰çº§.png | è§‚ä¼—ç”»åƒ-åŸå¸‚ç­‰çº§ |
| [5] | å…«å¤§äººç¾¤.png | è§‚ä¼—ç”»åƒ-äººç¾¤ |
| [6] | è®¾å¤‡æˆªå›¾.png | è§‚ä¼—ç”»åƒ-è®¾å¤‡ |

### å½“å‰æ•°æ®åº“é…ç½®ï¼ˆé”™è¯¯çš„ï¼‰

```javascript
"æ˜Ÿå›¾ä»·æ ¼æˆªå›¾": "screenshots.0.url",              // âœ… æ­£ç¡®
"è§‚ä¼—ç”»åƒæˆªå›¾-æ€§åˆ«": "screenshots.2.url",         // âœ… æ­£ç¡®
"è§‚ä¼—ç”»åƒæˆªå›¾-å¹´é¾„": "screenshots.4.url",         // âŒ é”™è¯¯ï¼åº”è¯¥æ˜¯ [3]
"è§‚ä¼—ç”»åƒæˆªå›¾-è®¾å¤‡": "screenshots.7.url",         // âŒ é”™è¯¯ï¼åº”è¯¥æ˜¯ [6]ï¼Œä¸” [7] ä¸å­˜åœ¨
"è§‚ä¼—ç”»åƒæˆªå›¾-åŸå¸‚ç­‰çº§": "screenshots.5.url",     // âŒ é”™è¯¯ï¼åº”è¯¥æ˜¯ [4]
"è§‚ä¼—ç”»åƒæˆªå›¾-äººç¾¤": "screenshots.6.url",         // âŒ é”™è¯¯ï¼åº”è¯¥æ˜¯ [5]
"è¿‘ä¸‰åå¤©è¾¾äººå•†å•vvä¸­ä½æ•°æˆªå›¾": "screenshots.1.url" // âœ… æ­£ç¡®
```

### ä¸ºä»€ä¹ˆå¹´é¾„åˆ†å¸ƒå›¾ä¼ ä¸ä¸Šå»ï¼Ÿ

```
å½“å‰é…ç½®ï¼šå¹´é¾„ â†’ screenshots[4]
å®é™…æ•°æ®ï¼šscreenshots[4] = åŸå¸‚ç­‰çº§.png  âŒ é”™è¯¯çš„å›¾ç‰‡ï¼

åº”è¯¥é…ç½®ï¼šå¹´é¾„ â†’ screenshots[3]
å®é™…æ•°æ®ï¼šscreenshots[3] = å¹´é¾„åˆ†å¸ƒ.png  âœ… æ­£ç¡®ï¼
```

---

## âŒ é”™è¯¯çš„å½±å“

### å½“å‰æ˜ å°„çš„ç»“æœ

| å­—æ®µ | å½“å‰æ˜ å°„ | å®é™…ä¸Šä¼ çš„å›¾ç‰‡ | åº”è¯¥ä¸Šä¼ çš„å›¾ç‰‡ |
|------|---------|---------------|--------------|
| è§‚ä¼—ç”»åƒæˆªå›¾-å¹´é¾„ | [4] | åŸå¸‚ç­‰çº§.png âŒ | å¹´é¾„åˆ†å¸ƒ.png |
| è§‚ä¼—ç”»åƒæˆªå›¾-è®¾å¤‡ | [7] | ä¸å­˜åœ¨ âŒ | è®¾å¤‡æˆªå›¾.png |
| è§‚ä¼—ç”»åƒæˆªå›¾-åŸå¸‚ç­‰çº§ | [5] | å…«å¤§äººç¾¤.png âŒ | åŸå¸‚ç­‰çº§.png |
| è§‚ä¼—ç”»åƒæˆªå›¾-äººç¾¤ | [6] | è®¾å¤‡æˆªå›¾.png âŒ | å…«å¤§äººç¾¤.png |

**ç»“è®º**ï¼š4 ä¸ªå­—æ®µçš„å›¾ç‰‡éƒ½é”™ä½äº†ï¼åªæœ‰å¹´é¾„å®Œå…¨æ²¡å›¾ï¼ˆå› ä¸ºæ˜ å°„åˆ°äº†å…¶ä»–å­—æ®µï¼‰

---

## âœ… æ­£ç¡®çš„ä¿®å¤æ–¹æ¡ˆ

### MongoDB æ›´æ–°å‘½ä»¤

```javascript
db.mapping_templates.updateOne(
  { _id: ObjectId("68d6bbbabffa4220ddf20928") },
  {
    $set: {
      "mappingRules.è§‚ä¼—ç”»åƒæˆªå›¾-å¹´é¾„": "automation-tasks.result.screenshots.3.url",
      "mappingRules.è§‚ä¼—ç”»åƒæˆªå›¾-åŸå¸‚ç­‰çº§": "automation-tasks.result.screenshots.4.url",
      "mappingRules.è§‚ä¼—ç”»åƒæˆªå›¾-äººç¾¤": "automation-tasks.result.screenshots.5.url",
      "mappingRules.è§‚ä¼—ç”»åƒæˆªå›¾-è®¾å¤‡": "automation-tasks.result.screenshots.6.url"
    }
  }
);
```

### å®Œæ•´çš„æ­£ç¡®æ˜ å°„

ä¿®å¤åçš„å®Œæ•´ `mappingRules`ï¼ˆå›¾ç‰‡éƒ¨åˆ†ï¼‰ï¼š

```javascript
{
  // ä»·æ ¼ç›¸å…³
  "æ˜Ÿå›¾ä»·æ ¼æˆªå›¾": "automation-tasks.result.screenshots.0.url",

  // è§‚ä¼—ç”»åƒç›¸å…³ï¼ˆæŒ‰ screenshots æ•°ç»„é¡ºåºï¼‰
  "è§‚ä¼—ç”»åƒæˆªå›¾-æ€§åˆ«": "automation-tasks.result.screenshots.2.url",      // [2] ç”·å¥³æ¯”ä¾‹
  "è§‚ä¼—ç”»åƒæˆªå›¾-å¹´é¾„": "automation-tasks.result.screenshots.3.url",      // [3] å¹´é¾„åˆ†å¸ƒ â† ä¿®æ­£
  "è§‚ä¼—ç”»åƒæˆªå›¾-åŸå¸‚ç­‰çº§": "automation-tasks.result.screenshots.4.url",  // [4] åŸå¸‚ç­‰çº§ â† ä¿®æ­£
  "è§‚ä¼—ç”»åƒæˆªå›¾-äººç¾¤": "automation-tasks.result.screenshots.5.url",      // [5] å…«å¤§äººç¾¤ â† ä¿®æ­£
  "è§‚ä¼—ç”»åƒæˆªå›¾-è®¾å¤‡": "automation-tasks.result.screenshots.6.url",      // [6] è®¾å¤‡æˆªå›¾ â† ä¿®æ­£

  // å•†å•æ•°æ®ç›¸å…³
  "è¿‘ä¸‰åå¤©è¾¾äººå•†å•vvä¸­ä½æ•°æˆªå›¾": "automation-tasks.result.screenshots.1.url"  // [1] æ˜Ÿå›¾è§†é¢‘
}
```

---

## ğŸ” å¦‚ä½•éªŒè¯ screenshots é¡ºåºï¼Ÿ

### æ–¹æ³• 1: æŸ¥çœ‹è‡ªåŠ¨åŒ–ä»»åŠ¡ç»“æœ

```javascript
db.automation_tasks.findOne(
  { _id: ObjectId("692490f838a85e81d50e5782") },
  { "result.screenshots": 1 }
);
```

åº”è¯¥èƒ½çœ‹åˆ°ï¼š
```javascript
{
  "result": {
    "screenshots": [
      { "name": "è¾¾äººä»·æ ¼.png", "url": "https://..." },
      { "name": "æ˜Ÿå›¾è§†é¢‘.png", "url": "https://..." },
      { "name": "ç”·å¥³æ¯”ä¾‹.png", "url": "https://..." },
      { "name": "å¹´é¾„åˆ†å¸ƒ.png", "url": "https://..." },  // â† [3]
      { "name": "åŸå¸‚ç­‰çº§.png", "url": "https://..." },  // â† [4]
      { "name": "å…«å¤§äººç¾¤.png", "url": "https://..." },  // â† [5]
      { "name": "è®¾å¤‡æˆªå›¾.png", "url": "https://..." }   // â† [6]
    ]
  }
}
```

### æ–¹æ³• 2: å¯¹ç…§å‰ç«¯æˆªå›¾

å‰ç«¯æˆªå›¾æ˜¾ç¤ºçš„å›¾ç‰‡é¡ºåºï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰ï¼š
1. è¾¾äººä»·æ ¼.png
2. æ˜Ÿå›¾è§†é¢‘.png
3. ç”·å¥³æ¯”ä¾‹.png
4. **å¹´é¾„åˆ†å¸ƒ.png** â† è¿™ä¸ª
5. åŸå¸‚ç­‰çº§.png
6. å…«å¤§äººç¾¤.png
7. è®¾å¤‡æˆªå›¾.png

---

## ğŸš€ ä¿®å¤æ­¥éª¤

### æ­¥éª¤ 1: å¤‡ä»½å½“å‰é…ç½®ï¼ˆå¯é€‰ä½†æ¨èï¼‰

```javascript
db.mapping_templates.findOne(
  { _id: ObjectId("68d6bbbabffa4220ddf20928") }
);
// å¤åˆ¶è¾“å‡ºä¿å­˜ä¸ºå¤‡ä»½
```

### æ­¥éª¤ 2: æ‰§è¡Œæ›´æ–°

```javascript
db.mapping_templates.updateOne(
  { _id: ObjectId("68d6bbbabffa4220ddf20928") },
  {
    $set: {
      "mappingRules.è§‚ä¼—ç”»åƒæˆªå›¾-å¹´é¾„": "automation-tasks.result.screenshots.3.url",
      "mappingRules.è§‚ä¼—ç”»åƒæˆªå›¾-åŸå¸‚ç­‰çº§": "automation-tasks.result.screenshots.4.url",
      "mappingRules.è§‚ä¼—ç”»åƒæˆªå›¾-äººç¾¤": "automation-tasks.result.screenshots.5.url",
      "mappingRules.è§‚ä¼—ç”»åƒæˆªå›¾-è®¾å¤‡": "automation-tasks.result.screenshots.6.url"
    }
  }
);
```

åº”è¯¥è¿”å›ï¼š
```
{ acknowledged: true, matchedCount: 1, modifiedCount: 1 }
```

### æ­¥éª¤ 3: éªŒè¯ä¿®å¤

```javascript
db.mapping_templates.findOne(
  { _id: ObjectId("68d6bbbabffa4220ddf20928") },
  { "mappingRules": 1 }
);
```

æ£€æŸ¥å›¾ç‰‡å­—æ®µçš„æ˜ å°„æ˜¯å¦æ­£ç¡®ã€‚

### æ­¥éª¤ 4: é‡æ–°ç”Ÿæˆæµ‹è¯•

1. æ‰“å¼€ `project_automation` é¡µé¢
2. é€‰æ‹©ä»»åŠ¡é‡æ–°ç”Ÿæˆé£ä¹¦è¡¨æ ¼
3. æ£€æŸ¥ç”Ÿæˆçš„è¡¨æ ¼ï¼š
   - âœ… è§‚ä¼—ç”»åƒæˆªå›¾-å¹´é¾„ åº”è¯¥æœ‰å¹´é¾„åˆ†å¸ƒå›¾
   - âœ… è§‚ä¼—ç”»åƒæˆªå›¾-åŸå¸‚ç­‰çº§ åº”è¯¥æœ‰åŸå¸‚ç­‰çº§å›¾
   - âœ… è§‚ä¼—ç”»åƒæˆªå›¾-äººç¾¤ åº”è¯¥æœ‰å…«å¤§äººç¾¤å›¾
   - âœ… è§‚ä¼—ç”»åƒæˆªå›¾-è®¾å¤‡ åº”è¯¥æœ‰è®¾å¤‡æˆªå›¾

---

## ğŸ“‹ å®Œæ•´çš„ä¿®å¤æ¸…å•

ä¿®å¤å‰åå¯¹æ¯”ï¼š

| å­—æ®µ | ä¿®å¤å‰ | ä¿®å¤å | çŠ¶æ€ |
|------|-------|-------|------|
| æ˜Ÿå›¾ä»·æ ¼æˆªå›¾ | [0] âœ… | [0] âœ… | æ— éœ€ä¿®æ”¹ |
| è§‚ä¼—ç”»åƒæˆªå›¾-æ€§åˆ« | [2] âœ… | [2] âœ… | æ— éœ€ä¿®æ”¹ |
| è§‚ä¼—ç”»åƒæˆªå›¾-å¹´é¾„ | [4] âŒ | [3] âœ… | **éœ€ä¿®æ­£** |
| è§‚ä¼—ç”»åƒæˆªå›¾-è®¾å¤‡ | [7] âŒ | [6] âœ… | **éœ€ä¿®æ­£** |
| è§‚ä¼—ç”»åƒæˆªå›¾-åŸå¸‚ç­‰çº§ | [5] âŒ | [4] âœ… | **éœ€ä¿®æ­£** |
| è§‚ä¼—ç”»åƒæˆªå›¾-äººç¾¤ | [6] âŒ | [5] âœ… | **éœ€ä¿®æ­£** |
| è¿‘ä¸‰åå¤©è¾¾äººå•†å•vvä¸­ä½æ•° | [1] âœ… | [1] âœ… | æ— éœ€ä¿®æ”¹ |

---

**ä¿®å¤è„šæœ¬**: [database/kol_data/scripts/fix-screenshots-mapping-correct.js](database/kol_data/scripts/fix-screenshots-mapping-correct.js)
