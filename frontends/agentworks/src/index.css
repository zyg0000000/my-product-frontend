/**
 * AgentWorks - 全局样式入口
 *
 * 样式分层策略：
 * 1. 设计令牌层 (CSS Variables) → 单一真相来源
 * 2. Tailwind 工具类层 → 引用 CSS Variables
 * 3. 组件样式层 (CSS Modules / BEM) → 复杂组件专属样式
 *
 * @see docs/DESIGN_SYSTEM.md
 */

/* ========================================
   1. 设计系统令牌
   ======================================== */
@import './design-system/tokens/index.css';

/* ========================================
   2. Tailwind CSS
   ======================================== */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========================================
   3. 基础重置与全局样式
   ======================================== */

@layer base {
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    font-variant-numeric: tabular-nums;
  }

  body {
    font-family: var(--aw-font-body);
    background-color: var(--aw-gray-50);
    color: var(--aw-gray-800);
    line-height: var(--aw-leading-normal);
    font-size: var(--aw-text-base);
  }

  /* 输入框默认样式 - 防止黑色背景 bug */
  input,
  textarea,
  select {
    background-color: transparent;
    color: inherit;
  }

  input::placeholder,
  textarea::placeholder {
    color: var(--aw-gray-400);
  }

  /* 链接 */
  a {
    color: var(--aw-primary-600);
    text-decoration: none;
    transition: color var(--aw-duration-fast) var(--aw-ease-default);
  }

  a:hover {
    color: var(--aw-primary-700);
  }

  /* 选中状态 */
  ::selection {
    background-color: var(--aw-primary-100);
    color: var(--aw-primary-900);
  }

  /* 焦点样式 */
  :focus-visible {
    outline: 2px solid var(--aw-primary-500);
    outline-offset: 2px;
  }

  /* 滚动条样式 - Webkit */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--aw-gray-300);
    border-radius: 3px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--aw-gray-400);
  }

  /* 滚动条样式 - Firefox */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--aw-gray-300) transparent;
  }
}

/* ========================================
   4. 组件基础样式
   ======================================== */

@layer components {
  /* 按钮基础 */
  .btn {
    @apply px-4 py-2 rounded-lg font-medium transition-all
           focus:outline-none focus:ring-2 focus:ring-offset-2
           disabled:opacity-50 disabled:cursor-not-allowed;
    font-family: var(--aw-font-body);
  }

  .btn-primary {
    @apply btn bg-primary-600 text-white
           hover:bg-primary-700 active:bg-primary-800
           focus:ring-primary-500;
    box-shadow: var(--aw-shadow-primary);
  }

  .btn-secondary {
    @apply btn bg-white text-gray-700 border border-gray-200
           hover:bg-gray-50 hover:border-gray-300
           active:bg-gray-100 focus:ring-gray-300;
  }

  .btn-ghost {
    @apply btn bg-transparent text-gray-600
           hover:bg-gray-100 hover:text-gray-900
           active:bg-gray-200;
  }

  .btn-danger {
    @apply btn bg-danger-600 text-white
           hover:bg-danger-700 active:bg-danger-800
           focus:ring-danger-500;
    box-shadow: var(--aw-shadow-danger);
  }

  /* 卡片 */
  .card {
    @apply bg-white rounded-xl border border-gray-200 p-6;
    box-shadow: var(--aw-shadow-card);
  }

  .card-hover {
    @apply card cursor-pointer;
    transition: all var(--aw-duration-normal) var(--aw-ease-default);
  }

  .card-hover:hover {
    border-color: var(--aw-gray-300);
    box-shadow: var(--aw-shadow-card-hover);
    transform: translateY(-1px);
  }

  /* 输入框 */
  .input {
    @apply w-full border border-gray-200 rounded-lg px-3 py-2
           text-gray-900 placeholder-gray-400
           focus:outline-none focus:border-transparent;
    transition: all var(--aw-duration-fast) var(--aw-ease-default);
    box-shadow: var(--aw-shadow-inset);
  }

  .input:focus {
    box-shadow: var(--aw-shadow-focus);
    border-color: var(--aw-primary-500);
  }

  /* 标签 */
  .tag {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-full
           text-xs font-medium;
  }

  .tag-primary {
    @apply tag;
    background-color: var(--aw-primary-50);
    color: var(--aw-primary-700);
  }

  .tag-success {
    @apply tag;
    background-color: var(--aw-success-50);
    color: var(--aw-success-700);
  }

  .tag-warning {
    @apply tag;
    background-color: var(--aw-warning-50);
    color: var(--aw-warning-700);
  }

  .tag-danger {
    @apply tag;
    background-color: var(--aw-danger-50);
    color: var(--aw-danger-700);
  }

  .tag-info {
    @apply tag;
    background-color: var(--aw-info-50);
    color: var(--aw-info-700);
  }

  /* 页面容器 */
  .page-container {
    @apply mx-auto px-4 sm:px-6 lg:px-8 py-6;
    max-width: var(--aw-max-width-7xl);
  }

  /* 页面标题 */
  .page-title {
    font-family: var(--aw-font-display);
    font-size: var(--aw-text-2xl);
    font-weight: 600;
    color: var(--aw-gray-900);
    line-height: var(--aw-leading-tight);
  }

  .page-subtitle {
    font-size: var(--aw-text-sm);
    color: var(--aw-gray-500);
    margin-top: var(--aw-space-1);
  }

  /* 数据展示 */
  .data-value {
    font-family: var(--aw-font-mono);
    font-variant-numeric: tabular-nums;
  }

  .data-value-lg {
    @apply data-value;
    font-size: var(--aw-text-2xl);
    font-weight: 600;
  }

  /* 骨架屏 */
  .skeleton {
    @apply rounded;
    background: linear-gradient(
      90deg,
      var(--aw-gray-100) 25%,
      var(--aw-gray-200) 50%,
      var(--aw-gray-100) 75%
    );
    background-size: 200% 100%;
    animation: aw-shimmer 1.5s infinite;
  }

  /* 分割线 */
  .divider {
    @apply border-t border-gray-200 my-4;
  }

  .divider-vertical {
    @apply border-l border-gray-200 mx-4 h-full;
  }
}

/* ========================================
   5. 工具类
   ======================================== */

@layer utilities {
  /* 文字截断 */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* 隐藏滚动条但保持可滚动 */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* 玻璃拟态效果 */
  .glass {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }

  /* 渐变文字 */
  .text-gradient {
    background: linear-gradient(135deg, var(--aw-primary-600), var(--aw-primary-400));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
}

/* ========================================
   6. Ant Design 样式覆盖
   ======================================== */

/* 统一圆角 */
.ant-btn {
  border-radius: var(--aw-radius-md) !important;
}

.ant-input,
.ant-input-affix-wrapper,
.ant-select-selector,
.ant-picker,
.ant-input-number {
  border-radius: var(--aw-radius-md) !important;
}

.ant-card {
  border-radius: var(--aw-radius-lg) !important;
}

.ant-modal-content {
  border-radius: var(--aw-radius-xl) !important;
}

.ant-table {
  border-radius: var(--aw-radius-lg) !important;
  overflow: hidden;
}

.ant-dropdown-menu {
  border-radius: var(--aw-radius-lg) !important;
  box-shadow: var(--aw-shadow-dropdown) !important;
}

.ant-popover-inner {
  border-radius: var(--aw-radius-lg) !important;
}

.ant-tooltip-inner {
  border-radius: var(--aw-radius-sm) !important;
}

.ant-tag {
  border-radius: var(--aw-radius-sm) !important;
}

/* 主按钮样式增强 */
.ant-btn-primary {
  background-color: var(--aw-primary-600) !important;
  border-color: var(--aw-primary-600) !important;
  box-shadow: var(--aw-shadow-primary) !important;
}

.ant-btn-primary:hover,
.ant-btn-primary:focus {
  background-color: var(--aw-primary-700) !important;
  border-color: var(--aw-primary-700) !important;
}

.ant-btn-primary:active {
  background-color: var(--aw-primary-800) !important;
  border-color: var(--aw-primary-800) !important;
}

/* 默认按钮悬停效果 */
.ant-btn-default:hover {
  color: var(--aw-primary-600) !important;
  border-color: var(--aw-primary-300) !important;
}

/* 输入框焦点效果 */
.ant-input:focus,
.ant-input-focused,
.ant-input-affix-wrapper:focus,
.ant-input-affix-wrapper-focused,
.ant-select-focused .ant-select-selector,
.ant-picker-focused {
  border-color: var(--aw-primary-500) !important;
  box-shadow: var(--aw-shadow-focus) !important;
}

/* 表格样式 */
.ant-table-thead > tr > th {
  background-color: var(--aw-gray-50) !important;
  color: var(--aw-gray-700) !important;
  font-weight: 600 !important;
  border-bottom: 1px solid var(--aw-gray-200) !important;
}

.ant-table-tbody > tr:hover > td {
  background-color: var(--aw-gray-50) !important;
}

.ant-table-tbody > tr > td {
  border-bottom: 1px solid var(--aw-gray-100) !important;
}

/* 分页器 */
.ant-pagination-item-active {
  background-color: var(--aw-primary-600) !important;
  border-color: var(--aw-primary-600) !important;
}

.ant-pagination-item-active a {
  color: white !important;
}

/* 标签页 */
.ant-tabs-tab.ant-tabs-tab-active .ant-tabs-tab-btn {
  color: var(--aw-primary-600) !important;
}

.ant-tabs-ink-bar {
  background-color: var(--aw-primary-600) !important;
}

/* 开关 */
.ant-switch-checked {
  background-color: var(--aw-primary-600) !important;
}

/* 复选框 */
.ant-checkbox-checked .ant-checkbox-inner {
  background-color: var(--aw-primary-600) !important;
  border-color: var(--aw-primary-600) !important;
}

/* 单选框 */
.ant-radio-checked .ant-radio-inner {
  border-color: var(--aw-primary-600) !important;
}

.ant-radio-checked .ant-radio-inner::after {
  background-color: var(--aw-primary-600) !important;
}

/* 进度条 */
.ant-progress-bg {
  background-color: var(--aw-primary-600) !important;
}

/* 消息提示 */
.ant-message-notice-content {
  border-radius: var(--aw-radius-lg) !important;
  box-shadow: var(--aw-shadow-lg) !important;
}

/* 通知 */
.ant-notification-notice {
  border-radius: var(--aw-radius-lg) !important;
  box-shadow: var(--aw-shadow-lg) !important;
}

/* 抽屉 */
.ant-drawer-content {
  border-radius: var(--aw-radius-xl) 0 0 var(--aw-radius-xl) !important;
}

.ant-drawer-left .ant-drawer-content {
  border-radius: 0 var(--aw-radius-xl) var(--aw-radius-xl) 0 !important;
}

/* 空状态 */
.ant-empty-description {
  color: var(--aw-gray-400) !important;
}

/* ========================================
   7. Pro Components 样式覆盖
   ======================================== */

/* ProTable */
.ant-pro-table-search {
  background-color: var(--aw-gray-50) !important;
  border-radius: var(--aw-radius-lg) !important;
  margin-bottom: var(--aw-space-4) !important;
}

.ant-pro-table .ant-table {
  border-radius: var(--aw-radius-lg) !important;
}

/* ProCard */
.ant-pro-card {
  border-radius: var(--aw-radius-lg) !important;
}

/* ========================================
   8. 深色模式样式覆盖
   ======================================== */

/* 深色模式 - 全局 */
[data-theme="dark"],
.dark {
  color-scheme: dark;
}

/* 深色模式 - 组件类 */
.dark .card,
[data-theme="dark"] .card {
  @apply bg-gray-100 border-gray-200;
}

.dark .btn-secondary,
[data-theme="dark"] .btn-secondary {
  @apply bg-gray-200 text-gray-800 border-gray-300
         hover:bg-gray-300 hover:border-gray-400;
}

.dark .btn-ghost,
[data-theme="dark"] .btn-ghost {
  @apply text-gray-400 hover:bg-gray-200 hover:text-gray-100;
}

.dark .input,
[data-theme="dark"] .input {
  @apply border-gray-300 text-gray-900 placeholder-gray-500 bg-gray-100;
}

.dark .divider,
[data-theme="dark"] .divider {
  @apply border-gray-200;
}

/* 深色模式 - 玻璃效果 */
.dark .glass,
[data-theme="dark"] .glass {
  background: rgba(30, 41, 59, 0.8);
}

/* 深色模式 - 滚动条 */
.dark::-webkit-scrollbar-thumb,
[data-theme="dark"]::-webkit-scrollbar-thumb {
  background: var(--aw-gray-400);
}

.dark::-webkit-scrollbar-thumb:hover,
[data-theme="dark"]::-webkit-scrollbar-thumb:hover {
  background: var(--aw-gray-500);
}

/* ========================================
   9. 打印样式
   ======================================== */

@media print {
  body {
    background-color: white !important;
    color: black !important;
  }

  .no-print {
    display: none !important;
  }

  .page-break {
    page-break-before: always;
  }
}

/* ========================================
   9. 减少动画 (无障碍支持)
   ======================================== */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
